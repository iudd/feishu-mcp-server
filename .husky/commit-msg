#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# 检查提交消息格式
# 提交消息应该符合以下格式：
# <type>(<scope>): <subject>
# 例如：feat(api): add new endpoint for user registration
#
# 常见类型:
# feat:     新功能
# fix:      修复Bug
# docs:     文档变更
# style:    代码格式调整
# refactor: 代码重构
# perf:     性能优化
# test:     测试相关
# chore:    构建过程或辅助工具的变动

commit_msg_file=$1
commit_msg=$(cat "$commit_msg_file")

# 简单的正则表达式检查
commit_pattern="^(feat|fix|docs|style|refactor|perf|test|chore)(\(.+\))?: .+"

if ! echo "$commit_msg" | grep -E "$commit_pattern" > /dev/null; then
  echo "❌ 无效的提交消息格式"
  echo "提交消息格式应为: <type>(<scope>): <subject>"
  echo "例如: feat(api): add new user endpoint"
  echo ""
  echo "支持的类型:"
  echo "feat:     新功能"
  echo "fix:      修复Bug"
  echo "docs:     文档变更"
  echo "style:    代码格式调整"
  echo "refactor: 代码重构"
  echo "perf:     性能优化"
  echo "test:     测试相关"
  echo "chore:    构建过程或辅助工具的变动"
  echo ""
  echo "您的提交消息: \"$commit_msg\""
  exit 1
fi

echo "✅ 提交消息格式正确" 